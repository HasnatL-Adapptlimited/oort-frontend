<!-- Webmap selection -->
<mat-form-field appearance="outline" class="p-0 w-full">
  <mat-label>{{
    'components.widget.settings.map.properties.webmap' | translate
  }}</mat-label>
  <mat-select
    #arcGisWebMap
    (selectionChange)="selectionOnChange($event)"
    (openedChange)="onOpenSelect($event)"
    [formControl]="ngControl && $any(ngControl.control)"
    [value]="value"
  >
    <!-- Search -->
    <ng-container *ngTemplateOutlet="search"></ng-container>
    <!-- Regular options -->
    <mat-option *ngFor="let item of items$ | async" [value]="item.id">
      {{ item.title }}
    </mat-option>
  </mat-select>
  <!-- Remove value -->
  <safe-button
    matSuffix
    (click)="selectionOnChange({ value: null }); $event.stopPropagation()"
    [isIcon]="true"
    icon="close"
    variant="danger"
  ></safe-button>
</mat-form-field>

<!-- Search template -->
<ng-template #search>
  <mat-option class="!sticky top-0 !h-auto z-10 !bg-white !p-0">
    <mat-form-field appearance="fill" class="!w-full -mb-5">
      <mat-label>{{ 'common.placeholder.search' | translate }}</mat-label>
      <input matInput [formControl]="searchControl" type="text" />
      <safe-button
        matSuffix
        [isIcon]="true"
        icon="close"
        (click)="searchControl.setValue('')"
      ></safe-button>
    </mat-form-field>
  </mat-option>
</ng-template>
